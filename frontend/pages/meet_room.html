<!DOCTYPE html>
<html>
<head>
    <title>Interview Meeting Room</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
</head>
<body>
    <div id="videos">
        <video id="localVideo" autoplay playsinline></video>
        <div id="remoteVideos"></div>
    </div>
    <div id="participants"></div>

    <script>
        const socket = io();
        const meeting_id = '{{ meeting_id }}';
        let localStream;
        const peerConnections = {};

        // Get user media and start connection
        async function start() {
            try {
                localStream = await navigator.mediaDevices.getUserMedia({
                    audio: true,
                    video: true
                });
                document.getElementById('localVideo').srcObject = localStream;
                
                socket.emit('join_meeting', {
                    meeting_id: meeting_id,
                    user_name: localStorage.getItem('user_name')
                });
            } catch (e) {
                console.error('Error accessing media devices:', e);
            }
        }

        socket.on('user_joined', data => {
            document.getElementById('participants').innerHTML = 
                'Participants: ' + data.participants.join(', ');
        });

        socket.on('signal_received', async data => {
            // Handle WebRTC signaling
            // Implementation details for peer connection...
        });

        // Start when page loads
        start();
    </script>
</body>
</html> 